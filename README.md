1. deep clone nested array to avoid changing the original array

2. tweking problem: use variables instead of hardcoded code to avoid seperatley checking all relevent spot.

